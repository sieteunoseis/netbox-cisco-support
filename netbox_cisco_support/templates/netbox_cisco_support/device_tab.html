{% extends 'dcim/device/base.html' %}
{% load helpers %}

{% block content %}
<div class="row">
    <div class="col-12">
        {% if not show_tab %}
        <div class="alert alert-warning">
            <i class="mdi mdi-alert"></i> {{ error|default:"Device does not meet requirements for Cisco Support lookup (requires serial number and Cisco manufacturer)" }}
        </div>
        {% elif loading %}
        <!-- Loading state - htmx will fetch content -->
        <div id="cisco-support-content"
             hx-get="{% url 'plugins:netbox_cisco_support:device_content' pk=object.pk %}"
             hx-trigger="load"
             hx-swap="innerHTML">
            <div class="d-flex justify-content-center align-items-center py-5">
                <div class="text-center">
                    <div class="spinner-border text-primary mb-3" role="status" style="width: 3rem; height: 3rem;">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <p class="text-muted mb-0">Loading Cisco Support data...</p>
                    <p class="text-muted small">Fetching product info, EoX, bugs, and advisories from Cisco APIs</p>
                </div>
            </div>
        </div>
        {% else %}
        <!-- Direct content (for errors that don't need API calls) -->
        {% if error %}
        <div class="alert alert-warning">
            <i class="mdi mdi-alert"></i> {{ error }}
        </div>
        {% endif %}
        {% endif %}
    </div>
</div>
{% endblock %}
